{{ if (eq .chezmoi.os "linux") -}}
#!/usr/bin/env bash

source "{{ .chezmoi.sourceDir }}/.chezmoitemplates/bash.sh"
version="{{ .versions.aqua -}}"

is_aqua_required() {
  [ ! $(command -v aqua) ] || [ $(aqua -v | head -n1 | cut -d" " -f3 | sed "s/^/v/") != $version ]
}

pretty_print ">>>>> Aqua Install : Begin <<<<<"

if is_aqua_required; then
  pretty_print "> installing aqua $version"
  if ! curl -fsSL "https://raw.githubusercontent.com/aquaproj/aqua-installer/v3.0.0/aqua-installer" | bash -s -- -v "$version"; then
    pretty_print "Error: Failed to install aqua $version" "$fg_red"
    pretty_print "Check your internet connection and the aqua installer URL" "$fg_red"
    exit 1
  fi
  pretty_print "Successfully installed aqua $version" "$fg_green"
else
  pretty_print "> aqua $version already installed" "$fg_yellow"
fi

pretty_print ">>>>> Aqua Install : End <<<<<"
{{ end -}}
